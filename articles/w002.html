<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ES6 参数解构 Destructuring</title>
    <style>
        .article_page_left {
            float: left;
            text-align: left;
            padding: 0px;
            margin: 0px;
            display: block;
            width: 610px;
        }

        .text_info {
            line-height: 1.8;
            font-family: Helvetica, "Open Sans", Arial, "Hiragino Sans GB", "Microsoft YaHei", 微软雅黑, STHeiti, "WenQuanYi Micro Hei", SimSun, sans-serif;
            font-size: 14px;
            float: left;
            text-align: left;
            padding: 0px;
            margin: 10px 0;
            display: block;
            clear: both;
            width: 100%;
            color: #000;
        }

        blockquote {

            text-align: left;
            padding: 10px 10px 10px 45px;
            margin: 0 0 10px 0;
            clear: both;
            display: block;
            width: 553px;
            border: 1px solid #e8e8e8;
            background: #f4f4f4 url(../assets/images/gg.jpg) no-repeat left top;
        }
        .text_info p {
            font-size: 14px;
            line-height: 1.8;
            margin: 0 0 15px 0;
        }

        .text_info_article p, pre, ol li, ul li, h3 {
            float: none;
            clear: none;
        }
        .text_info p {
            padding: 0px;
            color: #000;
            display: block;
            width: 100%;
        }
        blockquote p {
            word-wrap: break-word !important;
        }

        pre[class*='language-'] {
            position: relative;
        }
        :not(pre) > code[class*="language-"], pre[class*="language-"] {
            background: #f5f2f0;
        }
        pre[class*="language-"] {
            padding: .5em;
            margin: .5em 0;
            overflow: auto;
        }
        code[class*="language-"], pre[class*="language-"] {
            color: black;
            text-shadow: 0 1px white;
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
            direction: ltr;
            text-align: left;
            white-space: pre;
            word-spacing: normal;
            word-break: normal;
            word-wrap: normal;
            line-height: 1.5;
            tab-size: 4;
            hyphens: none;
            z-index: 1000;
        }
        .text_info_article pre, .news_container > .text_info pre {
            font-size: 14px;
            width: 98%;
            float: none !important;
        }

        .text_info_article p, pre, ol li, ul li, h3 {
            float: none;
            clear: none;
        }
        .text_content_container h2 {
            clear: none;
            float: none;
        }
        h2 {
            float: left;
            text-align: left;
            padding: 0px;
            margin: 0 0 10px 0;
            display: block;
            width: 100%;
            font-size: 20px;
            color: #222222;
            line-height: 120%;
        }
        .token.atrule, .token.attr-value, .token.keyword {
            color: #07a;
        }
        address, caption, cite, code, dfn, em, strong, th, var {
            font-style: normal;
            font-weight: normal;
        }
        pre[class*="language-"]::selection, pre[class*="language-"] ::selection, code[class*="language-"]::selection, code[class*="language-"] ::selection {
            text-shadow: none;
            background: #b3d4fc;
        }
        .token.function {
            color: #DD4A68;
        }
        .token.selector, .token.attr-name, .token.string, .token.char, .token.builtin, .token.inserted {
            color: #690;
        }
        .token.comment, .token.prolog, .token.doctype, .token.cdata {
            color: slategray;
        }
    </style>
</head>
<body>
<div class="text_info text_info_article">


    <blockquote>
        <p><em>编者按：ECMAScript 6已经正式发布了，作为它最重要的方言，Javascript也即将迎来语法上的重大变革，InfoQ特开设“<a
                href="http://www.infoq.com/cn/es6-in-depth/" target="_blank">深入浅出ES6</a>”专栏，来看一下ES6将给我们带来哪些新内容。本专栏文章来自<a
                href="https://hacks.mozilla.org/category/es6-in-depth/https:/hacks.mozilla.org/category/es6-in-depth/"
                target="_blank">Mozilla Web开发者博客</a>，由作者授权翻译并发布。</em></p>
    </blockquote>

    <p><em>译者按：Firefox开发者工具工程师<a href="http://fitzgeraldnick.com/" target="_blank">Nick Fitzgerald</a>最初在他的博客上发布了一篇文章——《<a
            href="http://fitzgeraldnick.com/weblog/50/" target="_blank">ES6中的解构赋值</a>》，本文基于这篇博文做了些许补充。</em></p>

    <p>
        <h3>本文地址:<a target="_blank" href="http://www.infoq.com/cn/articles/es6-in-depth-destructuring?utm_source=articles_about_ES6-In-Depth&utm_medium=link&utm_campaign=ES6-In-Depth">http://www.infoq.com/cn/articles/es6-in-depth-destructuring?utm_source=articles_about_ES6-In-Depth&utm_medium=link&utm_campaign=ES6-In-Depth</a></h3>
    </p>
    <h2>什么是解构赋值？</h2>


    <p>解构赋值允许你使用类似数组或对象字面量的语法将数组和对象的属性赋给各种变量。这种赋值语法极度简洁，同时还比传统的属性访问方法更为清晰。</p>

    <p>通常来说，你很可能这样访问数组中的前三个元素：</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span class="token keyword">var</span> first <span
            class="token operator">=</span> someArray<span class="token punctuation">[</span><span class="token number">0</span><span
            class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> second <span class="token operator">=</span> someArray<span
                class="token punctuation">[</span><span class="token number">1</span><span
                class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> third <span class="token operator">=</span> someArray<span
                class="token punctuation">[</span><span class="token number">2</span><span
                class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>


    <p>如果使用解构赋值的特性，将会使等效的代码变得更加简洁并且可读性更高：</p>

    <pre class=" language-javascript"><code class=" language-javascript">
    <span class="token keyword">var</span> <span class="token punctuation">[</span>first<span class="token punctuation">,</span> second<span
            class="token punctuation">,</span> third<span class="token punctuation">]</span> <span
            class="token operator">=</span> someArray<span class="token punctuation">;</span></code></pre>

    <p>SpiderMonkey（Firefox的JavaScript引擎）已经支持解构的大部分功能，但是仍不健全。你可以通过<a
            href="https://bugzilla.mozilla.org/show_bug.cgi?id=694100" target="_blank">bug 694100</a>跟踪解构和其它ES6特性在SpiderMonkey中的支持情况。
    </p>

    <h2>数组与迭代器的解构</h2>

    <p>以上是数组解构赋值的一个简单示例，其语法的一般形式为：</p>

    <pre class=" language-javascript"><code class=" language-javascript">
    <span class="token punctuation">[</span> variable1<span class="token punctuation">,</span> variable2<span
            class="token punctuation">,</span> <span class="token punctuation">.</span><span
            class="token punctuation">.</span><span class="token punctuation">.</span><span
            class="token punctuation">,</span> variableN <span class="token punctuation">]</span> <span
            class="token operator">=</span> array<span class="token punctuation">;</span></code></pre>

    <p>
        这将为variable1到variableN的变量赋予数组中相应元素项的值。如果你想在赋值的同时声明变量，可在赋值语句前加入<code>var</code>、<code>let</code>或<code>const</code>关键字，例如：
    </p>

    <pre class=" language-javascript"><code class=" language-javascript">
    <span class="token keyword">var</span> <span class="token punctuation">[</span> variable1<span
            class="token punctuation">,</span> variable2<span class="token punctuation">,</span> <span
            class="token punctuation">.</span><span class="token punctuation">.</span><span
            class="token punctuation">.</span><span class="token punctuation">,</span> variableN <span
            class="token punctuation">]</span> <span class="token operator">=</span> array<span
            class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token punctuation">[</span> variable1<span
            class="token punctuation">,</span> variable2<span class="token punctuation">,</span> <span
            class="token punctuation">.</span><span class="token punctuation">.</span><span
            class="token punctuation">.</span><span class="token punctuation">,</span> variableN <span
            class="token punctuation">]</span> <span class="token operator">=</span> array<span
            class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span> variable1<span
            class="token punctuation">,</span> variable2<span class="token punctuation">,</span> <span
            class="token punctuation">.</span><span class="token punctuation">.</span><span
            class="token punctuation">.</span><span class="token punctuation">,</span> variableN <span
            class="token punctuation">]</span> <span class="token operator">=</span> array<span
            class="token punctuation">;</span></code></pre>

    <p>事实上，用<code>变量</code>来描述并不恰当，因为你可以对任意深度的嵌套数组进行解构：</p>

    <pre class=" language-javascript"><code class=" language-javascript">
    <span class="token keyword">var</span> <span class="token punctuation">[</span>foo<span
            class="token punctuation">,</span> <span class="token punctuation">[</span><span
            class="token punctuation">[</span>bar<span class="token punctuation">]</span><span
            class="token punctuation">,</span> baz<span class="token punctuation">]</span><span
            class="token punctuation">]</span> <span class="token operator">=</span> <span
            class="token punctuation">[</span><span class="token number">1</span><span
            class="token punctuation">,</span> <span class="token punctuation">[</span><span
            class="token punctuation">[</span><span class="token number">2</span><span
            class="token punctuation">]</span><span class="token punctuation">,</span> <span
            class="token number">3</span><span class="token punctuation">]</span><span
            class="token punctuation">]</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
            class="token punctuation">(</span>foo<span class="token punctuation">)</span><span
            class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 1</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
            class="token punctuation">(</span>bar<span class="token punctuation">)</span><span
            class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 2</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
            class="token punctuation">(</span>baz<span class="token punctuation">)</span><span
            class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 3</span></code></pre>

    <p>此外，你可以在对应位留空来跳过被解构数组中的某些元素：</p>

    <pre class=" language-javascript"><code class=" language-javascript">
    <span class="token keyword">var</span> <span class="token punctuation">[</span><span
            class="token punctuation">,</span><span class="token punctuation">,</span>third<span
            class="token punctuation">]</span> <span class="token operator">=</span> <span
            class="token punctuation">[</span><span class="token string">"foo"</span><span
            class="token punctuation">,</span> <span class="token string">"bar"</span><span
            class="token punctuation">,</span> <span class="token string">"baz"</span><span
            class="token punctuation">]</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
            class="token punctuation">(</span>third<span class="token punctuation">)</span><span
            class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// "baz"</span></code></pre>

    <p>而且你还可以通过“<a href="http://www.infoq.com/cn/articles/es6-in-depth-rest-parameters-and-defaults" target="_blank">不定参数</a>”模式捕获数组中的所有尾随元素：
    </p>

    <pre class=" language-javascript"><code class=" language-javascript">
    <span class="token keyword">var</span> <span class="token punctuation">[</span>head<span
            class="token punctuation">,</span> <span class="token punctuation">.</span><span
            class="token punctuation">.</span><span class="token punctuation">.</span>tail<span
            class="token punctuation">]</span> <span class="token operator">=</span> <span
            class="token punctuation">[</span><span class="token number">1</span><span
            class="token punctuation">,</span> <span class="token number">2</span><span
            class="token punctuation">,</span> <span class="token number">3</span><span
            class="token punctuation">,</span> <span class="token number">4</span><span
            class="token punctuation">]</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
            class="token punctuation">(</span>tail<span class="token punctuation">)</span><span
            class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// [2, 3, 4]</span></code></pre>

    <p>当访问空数组或越界访问数组时，对其解构与对其索引的行为一致，最终得到的结果都是：<code>undefined</code>。</p>

    <pre class=" language-javascript"><code class=" language-javascript">    console<span
            class="token punctuation">.</span><span class="token function">log</span><span
            class="token punctuation">(</span><span class="token punctuation">[</span><span
            class="token punctuation">]</span><span class="token punctuation">[</span><span
            class="token number">0</span><span class="token punctuation">]</span><span
            class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// undefined</span>
    <span class="token keyword">var</span> <span class="token punctuation">[</span>missing<span
                class="token punctuation">]</span> <span class="token operator">=</span> <span
                class="token punctuation">[</span><span class="token punctuation">]</span><span
                class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
                class="token punctuation">(</span>missing<span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// undefined</span></code></pre>

    <p>请注意，数组解构赋值的模式同样适用于任意迭代器：</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span class="token keyword">function</span><span
            class="token operator">*</span> <span class="token function">fibs</span><span
            class="token punctuation">(</span><span class="token punctuation">)</span> <span
            class="token punctuation">{</span>
      <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">0</span><span
                class="token punctuation">;</span>
      <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">1</span><span
                class="token punctuation">;</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span><span
                class="token boolean">true</span><span class="token punctuation">)</span> <span
                class="token punctuation">{</span>
        <span class="token keyword">yield</span> a<span class="token punctuation">;</span>
        <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span
                class="token punctuation">]</span> <span class="token operator">=</span> <span
                class="token punctuation">[</span>b<span class="token punctuation">,</span> a <span
                class="token operator">+</span> b<span class="token punctuation">]</span><span
                class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> <span class="token punctuation">[</span>first<span class="token punctuation">,</span> second<span
                class="token punctuation">,</span> third<span class="token punctuation">,</span> fourth<span
                class="token punctuation">,</span> fifth<span class="token punctuation">,</span> sixth<span
                class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">fibs</span><span
                class="token punctuation">(</span><span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
                class="token punctuation">(</span>sixth<span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 5</span></code></pre>

    <h2>对象的解构</h2>

    <p>通过解构对象，你可以把它的每个属性与不同的变量绑定，首先指定被绑定的属性，然后紧跟一个要解构的变量。</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span class="token keyword">var</span> robotA <span
            class="token operator">=</span> <span class="token punctuation">{</span> name<span
            class="token punctuation">:</span> <span class="token string">"Bender"</span> <span
            class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> robotB <span class="token operator">=</span> <span class="token punctuation">{</span> name<span
                class="token punctuation">:</span> <span class="token string">"Flexo"</span> <span
                class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> nameA <span
                class="token punctuation">}</span> <span class="token operator">=</span> robotA<span
                class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> nameB <span
                class="token punctuation">}</span> <span class="token operator">=</span> robotB<span
                class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
                class="token punctuation">(</span>nameA<span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// "Bender"</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
                class="token punctuation">(</span>nameB<span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// "Flexo"</span></code></pre>

    <p>当属性名与变量名一致时，可以通过一种实用的句法简写：</p>

    <pre class=" language-javascript"><code class=" language-javascript">
    <span class="token keyword">var</span> <span class="token punctuation">{</span> foo<span
            class="token punctuation">,</span> bar <span class="token punctuation">}</span> <span
            class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span
            class="token string">"lorem"</span><span class="token punctuation">,</span> bar<span
            class="token punctuation">:</span> <span class="token string">"ipsum"</span> <span
            class="token punctuation">}</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
            class="token punctuation">(</span>foo<span class="token punctuation">)</span><span
            class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// "lorem"</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
            class="token punctuation">(</span>bar<span class="token punctuation">)</span><span
            class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// "ipsum"</span></code></pre>

    <p>与数组解构一样，你可以随意嵌套并进一步组合对象解构：</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span class="token keyword">var</span> complicatedObj <span
            class="token operator">=</span> <span class="token punctuation">{</span>
      arrayProp<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">"Zapp"</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> second<span class="token punctuation">:</span> <span
                class="token string">"Brannigan"</span> <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token punctuation">{</span> arrayProp<span
                class="token punctuation">:</span> <span class="token punctuation">[</span>first<span
                class="token punctuation">,</span> <span class="token punctuation">{</span> second <span
                class="token punctuation">}</span><span class="token punctuation">]</span> <span
                class="token punctuation">}</span> <span class="token operator">=</span> complicatedObj<span
                class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
                class="token punctuation">(</span>first<span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// "Zapp"</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
                class="token punctuation">(</span>second<span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// "Brannigan"</span></code></pre>

    <p>当你解构一个未定义的属性时，得到的值为<code>undefined</code>：</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span
            class="token keyword">var</span> <span class="token punctuation">{</span> missing <span
            class="token punctuation">}</span> <span class="token operator">=</span> <span
            class="token punctuation">{</span><span class="token punctuation">}</span><span
            class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
                class="token punctuation">(</span>missing<span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// undefined</span></code></pre>

    <p>请注意，当你解构对象并赋值给变量时，如果你已经声明或不打算声明这些变量（亦即赋值语句前没有<code>let</code>、<code>const</code>或<code>var</code>关键字），你应该注意这样一个潜在的语法错误：
    </p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span class="token punctuation">{</span> blowUp <span
            class="token punctuation">}</span> <span class="token operator">=</span> <span
            class="token punctuation">{</span> blowUp<span class="token punctuation">:</span> <span
            class="token number">10</span> <span class="token punctuation">}</span><span
            class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// Syntax error 语法错误</span></code></pre>

    <p>为什么会出错？这是因为JavaScript语法通知解析引擎将任何以{开始的语句解析为一个块语句（例如，<code>{console}</code>是一个合法块语句）。解决方案是将整个表达式用一对小括号包裹：</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span
            class="token punctuation">(</span><span class="token punctuation">{</span> safe <span
            class="token punctuation">}</span> <span class="token operator">=</span> <span
            class="token punctuation">{</span><span class="token punctuation">}</span><span
            class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// No errors 没有语法错误</span></code></pre>

    <h2>解构值不是对象、数组或迭代器</h2>

    <p>当你尝试解构<code>null</code>或<code>undefined</code>时，你会得到一个类型错误：</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span
            class="token keyword">var</span> <span class="token punctuation">{</span>blowUp<span
            class="token punctuation">}</span> <span class="token operator">=</span> <span
            class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// TypeError: null has no properties（null没有属性）</span></code></pre>

    <p>然而，你可以解构其它原始类型，例如：<code>布尔值</code>、<code>数值</code>、<code>字符串</code>，但是你将得到<code>undefined</code>：</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span
            class="token keyword">var</span> <span class="token punctuation">{</span>wtf<span class="token punctuation">}</span> <span
            class="token operator">=</span> <span class="token number">NaN</span><span
            class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
                class="token punctuation">(</span>wtf<span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// undefined</span></code></pre>

    <p>你可能对此感到意外，但经过进一步审查你就会发现，原因其实非常简单。当使用对象赋值模式时，被解构的值<a
            href="https://people.mozilla.org/%7Ejorendorff/es6-draft.html#sec-requireobjectcoercible" target="_blank">需要被强制转换为对象</a>。大多数类型都可以被转换为对象，但<code>null</code>和<code>undefined</code>却无法进行转换。当使用数组赋值模式时，被解构的值一定要<a
            href="https://people.mozilla.org/%7Ejorendorff/es6-draft.html#sec-getiterator" target="_blank">包含一个迭代器</a>。
    </p>

    <h2>默认值</h2>

    <p>当你要解构的属性未定义时你可以提供一个默认值：</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span
            class="token keyword">var</span> <span class="token punctuation">[</span>missing <span
            class="token operator">=</span> <span class="token boolean">true</span><span
            class="token punctuation">]</span> <span class="token operator">=</span> <span
            class="token punctuation">[</span><span class="token punctuation">]</span><span
            class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
                class="token punctuation">(</span>missing<span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// true</span>
    <span class="token keyword">var</span> <span class="token punctuation">{</span> message<span
                class="token punctuation">:</span> msg <span class="token operator">=</span> <span class="token string">"Something went wrong"</span> <span
                class="token punctuation">}</span> <span class="token operator">=</span> <span
                class="token punctuation">{</span><span class="token punctuation">}</span><span
                class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
                class="token punctuation">(</span>msg<span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// "Something went wrong"</span>
    <span class="token keyword">var</span> <span class="token punctuation">{</span> x <span
                class="token operator">=</span> <span class="token number">3</span> <span
                class="token punctuation">}</span> <span class="token operator">=</span> <span
                class="token punctuation">{</span><span class="token punctuation">}</span><span
                class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span
                class="token punctuation">(</span>x<span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 3</span></code></pre>

    <p><em>(译者按：Firefox目前只实现了这个特性的前两种情况，第三种尚未实现。详情查看<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=932080"
                                                       target="_blank">bug 932080</a>。)</em></p>

    <h2>解构的实际应用</h2>

    <h3>函数参数定义</h3>

    <p>作 为开发者，我们需要实现设计良好的API，通常的做法是为函数为函数设计一个对象作为参数，然后将不同的实际参数作为对象属性，以避免让API使用者记住
        多个参数的使用顺序。我们可以使用解构特性来避免这种问题，当我们想要引用它的其中一个属性时，大可不必反复使用这种单一参数对象。</p>

    <pre class=" language-javascript"><code class=" language-javascript">
    <span class="token keyword">function</span> <span class="token function">removeBreakpoint</span><span
            class="token punctuation">(</span><span class="token punctuation">{</span> url<span
            class="token punctuation">,</span> line<span class="token punctuation">,</span> column <span
            class="token punctuation">}</span><span class="token punctuation">)</span> <span
            class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// ...</span>
    <span class="token punctuation">}</span></code></pre>

    <p>这是一段来自Firefox开发工具JavaScript调试器（同样使用JavaScript实现——没错，就是这样！）的代码片段，它看起来非常简洁，我们会发现这种代码模式特别讨喜。</p>

    <h3>配置对象参数</h3>

    <p>延伸一下之前的示例，我们同样可以给需要解构的对象属性赋予默认值。当我们构造一个提供配置的对象，并且需要这个对象的属性携带默认值时，解构特性就派上用场了。举个例子，jQuery的<code>ajax</code>函数使用一个配置对象作为它的第二参数，我们可以这样重写函数定义：
    </p>

    <pre class=" language-javascript"><code class=" language-javascript">    jQuery<span
            class="token punctuation">.</span>ajax <span class="token operator">=</span> <span class="token keyword">function</span> <span
            class="token punctuation">(</span>url<span class="token punctuation">,</span> <span
            class="token punctuation">{</span>
      <span class="token keyword">async</span> <span class="token operator">=</span> <span
                class="token boolean">true</span><span class="token punctuation">,</span>
      beforeSend <span class="token operator">=</span> noop<span class="token punctuation">,</span>
      cache <span class="token operator">=</span> <span class="token boolean">true</span><span
                class="token punctuation">,</span>
      complete <span class="token operator">=</span> noop<span class="token punctuation">,</span>
      crossDomain <span class="token operator">=</span> <span class="token boolean">false</span><span
                class="token punctuation">,</span>
      global <span class="token operator">=</span> <span class="token boolean">true</span><span
                class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// ... 更多配置</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span> <span
                class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// ... do stuff</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>

    <p>如此一来，我们可以避免对配置对象的每个属性都重复<code>var foo = config.foo || theDefaultFoo;</code>这样的操作。</p>

    <p><em>（编者按：不幸的是，对象的默认值简写语法仍未在Firefox中实现，我知道，上一个编者按后的几个段落讲解的就是这个特性。点击<a
            href="https://bugzilla.mozilla.org/show_bug.cgi?id=932080" target="_blank">bug 932080</a>查看最新详情。）</em></p>

    <h3>与ES6迭代器协议协同使用</h3>

    <p>ECMAScript 6中定义了一个<a href="https://hacks.mozilla.org/2015/04/es6-in-depth-iterators-and-the-for-of-loop/"
                            target="_blank">迭代器协议</a>，我们在《<a
            href="http://www.infoq.com/cn/articles/es6-in-depth-iterators-and-the-for-of-loop" target="_blank">深入浅出ES6（二）：迭代器和for-of循环</a>》中已经详细解析过。当你迭代<a
            href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" target="_blank">Maps</a>（ES6标准库中新加入的一种对象）后，你可以得到一系列形如<code>[key,
        value]</code>的键值对，我们可将这些键值对解构，更轻松地访问键和值：</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span class="token keyword">var</span> map <span
            class="token operator">=</span> <span class="token keyword">new</span> <span
            class="token class-name">Map</span><span class="token punctuation">(</span><span
            class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token keyword">set</span><span
                class="token punctuation">(</span>window<span class="token punctuation">,</span> <span
                class="token string">"the global"</span><span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token keyword">set</span><span
                class="token punctuation">(</span>document<span class="token punctuation">,</span> <span
                class="token string">"the document"</span><span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span
                class="token keyword">var</span> <span class="token punctuation">[</span>key<span
                class="token punctuation">,</span> value<span class="token punctuation">]</span> <span
                class="token keyword">of</span> map<span class="token punctuation">)</span> <span
                class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span
                class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">" is "</span> <span
                class="token operator">+</span> value<span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">// "[object Window] is the global"</span>
    <span class="token comment" spellcheck="true">// "[object HTMLDocument] is the document"</span></code></pre>

    <p>只遍历键：</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span
            class="token keyword">for</span> <span class="token punctuation">(</span><span
            class="token keyword">var</span> <span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span
            class="token keyword">of</span> map<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// ...</span>
    <span class="token punctuation">}</span></code></pre>

    <p>或只遍历值：</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span
            class="token keyword">for</span> <span class="token punctuation">(</span><span
            class="token keyword">var</span> <span class="token punctuation">[</span><span
            class="token punctuation">,</span>value<span class="token punctuation">]</span> <span class="token keyword">of</span> map<span
            class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// ...</span>
    <span class="token punctuation">}</span></code></pre>

    <h3>多重返回值</h3>

    <p>JavaScript语言中尚未整合多重返回值的特性，但是无须多此一举，因为你自己就可以返回一个数组并将结果解构：</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span class="token keyword">function</span> <span
            class="token function">returnMultipleValues</span><span class="token punctuation">(</span><span
            class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span
                class="token number">1</span><span class="token punctuation">,</span> <span
                class="token number">2</span><span class="token punctuation">]</span><span
                class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> <span class="token punctuation">[</span>foo<span
                class="token punctuation">,</span> bar<span class="token punctuation">]</span> <span
                class="token operator">=</span> <span class="token function">returnMultipleValues</span><span
                class="token punctuation">(</span><span class="token punctuation">)</span><span
                class="token punctuation">;</span></code></pre>

    <p>或者，你可以用一个对象作为容器并为返回值命名：</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span class="token keyword">function</span> <span
            class="token function">returnMultipleValues</span><span class="token punctuation">(</span><span
            class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        foo<span class="token punctuation">:</span> <span class="token number">1</span><span
                class="token punctuation">,</span>
        bar<span class="token punctuation">:</span> <span class="token number">2</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> <span class="token punctuation">{</span> foo<span
                class="token punctuation">,</span> bar <span class="token punctuation">}</span> <span
                class="token operator">=</span> <span class="token function">returnMultipleValues</span><span
                class="token punctuation">(</span><span class="token punctuation">)</span><span
                class="token punctuation">;</span></code></pre>

    <p>这两个模式都比额外保存一个临时变量要好得多。</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span class="token keyword">function</span> <span
            class="token function">returnMultipleValues</span><span class="token punctuation">(</span><span
            class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        foo<span class="token punctuation">:</span> <span class="token number">1</span><span
                class="token punctuation">,</span>
        bar<span class="token punctuation">:</span> <span class="token number">2</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> temp <span class="token operator">=</span> <span class="token function">returnMultipleValues</span><span
                class="token punctuation">(</span><span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token keyword">var</span> foo <span class="token operator">=</span> temp<span
                class="token punctuation">.</span>foo<span class="token punctuation">;</span>
    <span class="token keyword">var</span> bar <span class="token operator">=</span> temp<span
                class="token punctuation">.</span>bar<span class="token punctuation">;</span></code></pre>

    <p>或者使用CPS变换：</p>

    <pre class=" language-javascript"><code class=" language-javascript">    <span class="token keyword">function</span> <span
            class="token function">returnMultipleValues</span><span class="token punctuation">(</span>k<span
            class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">k</span><span class="token punctuation">(</span><span
                class="token number">1</span><span class="token punctuation">,</span> <span
                class="token number">2</span><span class="token punctuation">)</span><span
                class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">returnMultipleValues</span><span class="token punctuation">(</span><span
                class="token punctuation">(</span>foo<span class="token punctuation">,</span> bar<span
                class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span
                class="token punctuation">.</span><span class="token punctuation">.</span><span
                class="token punctuation">.</span><span class="token punctuation">)</span><span
                class="token punctuation">;</span></code></pre>

    <h3>使用解构导入部分CommonJS模块</h3>

    <p>
        你是否尚未使用ES6模块？还用着CommonJS的模块呢吧！没问题，当我们导入CommonJS模块X时，很可能在模块X中导出了许多你根本没打算用的函数。通过解构，你可以显式定义模块的一部分来拆分使用，同时还不会污染你的命名空间：</p>

    <pre class=" language-javascript"><code class=" language-javascript">
    <span class="token keyword">const</span> <span class="token punctuation">{</span> SourceMapConsumer<span
            class="token punctuation">,</span> SourceNode <span class="token punctuation">}</span> <span
            class="token operator">=</span> <span class="token function">require</span><span
            class="token punctuation">(</span><span class="token string">"source-map"</span><span
            class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

    <p>（如果你使用ES6模块，你一定知道在<code>import</code>声明中有一个相似的语法。）</p>

    <h2>文后盘点</h2>

    <p>所以，正如你所见，解构在许多独立小场景中非常实用。在Mozilla我们已经积累了许多有关解构的使用经验。十年前，Lars Hansen在Opera中引入了JS解构特性，Brendan
        Eich随后就给Firefox也增加了相应的支持，移植时版本为Firefox 2。所以我们可以肯定，渐渐地，你会在每天使用的语言中加入解构这个新特性，它可以让你的代码变得更加精简整洁。</p>

    <p>在第一篇文章中，我说过ES6很可能改变你写JavaScript的方式。这正是我日思夜想的特性：轻松学习，简单改进，合力出击，优化项目，在不断的进化中改革这门语言。</p>

    <p>感谢团队对于整个ES6解构特性的努力，特别感谢Tooru Fujisawa（arai）和Arpad Borsos（Swatinem）的出色贡献。</p>

    <p>Chrome中有关解构的支持正在开发中，其它浏览器也将适时增加支持。现在，如果你想在Web上使用解构功能，你需要使用<a href="http://babeljs.io/" target="_blank">Babel</a>或<a
            href="https://github.com/google/traceur-compiler#what-is-traceur" target="_blank">Traceur</a>将ES6代码转译为相应的ES5代码。
    </p>

    <hr>
    <p><em>再次感谢Nick Fitzgerald撰写ES6的解构特性。</em></p>

    <p><em>下一次，我们将讲解一个新特性，函数一直以来都是JavaScript语言的基础构建单元，如果我们用稍短的方式实现函数是否令你感到激动？我自信地预测你
        的答案一定是yes！不过别轻易相信我说的话，发布下一篇文章时记得亲自来看看，我们一起深入浅出ES6箭头函数（Arrow Function）。</em></p>


    <div class="clear"></div>

</div>
</body>
</html>